language: c
sudo: required
addons:
  apt:
    sources:
    - avsm
    packages:
    - opam
    - libogg-dev
    - libspeex-dev

before_install:
  - export OPAMYES=1
  - opam init -y
  - opam install -q -y ocamlfind base-bytes
  - eval `opam config env`
  - git clone https://github.com/savonet/ocaml-ogg.git
  - cd ocaml-ogg && git submodule init && git submodule update && ./bootstrap && ./configure && make && cd ..

script:
  - ./bootstrap
  - ./configure --with-ogg-dir=ocaml-ogg/src
  - make
  - make -C examples OCAMLOGG_DIR=`pwd`/ocaml-ogg/src
